
<div class="purge-g">
    <div id="loader-container">
        <md-progress-bar [hidden]="!isLoading" mode="indeterminate"></md-progress-bar>
    </div>
    <div id="report-container">
        <button mdTooltip="Refresh the report" [disabled]="isLoading" (click)="refresh()" md-icon-button>
            <md-icon>refresh</md-icon>
        </button>
        <button mdTooltip="Reset filters" [disabled]="isLoading" (click)="refresh(true)" md-icon-button>
            <md-icon>clear</md-icon>
        </button>
        <button mdTooltip="Edit selection" [disabled]="isLoading || !hasSelection" (click)="edit()" md-icon-button>
            <md-icon>edit</md-icon>
        </button>
        <button mdTooltip="Remove selection" [disabled]="isLoading || !hasSelection" (click)="delete()" md-icon-button>
            <md-icon id="delete-icon">delete</md-icon>
        </button>
        <button mdTooltip="Add new item(s)" [disabled]="isLoading" (click)="add()" md-icon-button>
            <md-icon id="add-icon">add_circle</md-icon>
        </button>
        <button mdTooltip="Add filter" [disabled]="isLoading" (click)="reportFilter.addFilter()" md-icon-button>
            <md-icon >filter_list</md-icon>
        </button>
       
        <button id="more-button" md-icon-button [mdMenuTriggerFor]="menu" >
            <md-icon>more_vert</md-icon>
        </button>
        <md-menu #menu="mdMenu">
            <button md-menu-item (click)="export()">
                <md-icon>file_download</md-icon>
                <span>Export</span>
            </button>
        </md-menu>

        <div  >
            <ac-filter #reportFilter
                [fields]="fields"
                (filtersModified)="refresh()">
            </ac-filter>
        </div>

        <table>
            <tr>
                <th class="line-selector-cell">
                    <md-checkbox (change)="selectAllLines($event)"></md-checkbox>
                </th>
                <th (click)="sort(field)"  *ngFor="let field of fields">{{formatHeader(field.name)}}
                    <md-icon class="sort-icon" *ngIf="getFieldSorting(field) == 1">keyboard_arrow_down</md-icon>
                    <md-icon class="sort-icon" *ngIf="getFieldSorting(field) == -1">keyboard_arrow_up</md-icon>
                </th>
            </tr>

            <tr *ngFor="let item of items" (dblclick)="editLine(item)" >
                <td class=line-selector-cell >
                    <md-checkbox [(checked)]="item.isSelected" (change)="selectLine(item.uuid)"></md-checkbox>
                <td *ngFor="let field of fields">{{formatCell(item.object, field)}}</td>
            </tr>
        </table>
        
    </div>
    <div id="pager" class="pure-u-1 pure-u-md-1-2 pure-u-lg-1-4 pure-u-xl-1-6">
        <button [disabled]="page == 0 || isLoading" (click)="pageBefore()" md-icon-button>
            <md-icon>navigate_before</md-icon>
        </button>
        <div id="page-num">{{page}}</div>
        <button [disabled]="isLoading || items.length != pageSize" (click)="pageNext()" md-icon-button>
            <md-icon>navigate_next</md-icon>
        </button>
    </div>
</div>
